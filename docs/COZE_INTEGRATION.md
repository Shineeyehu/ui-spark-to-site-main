# 扣子智能体集成说明

## 概述

本项目已成功集成扣子 Web SDK，用于在 `/birthday` 页面提供 AI 驱动的智能对话功能。

## 功能特性

### 1. 智能体对话选项
- 用户可以选择使用传统报告或 AI 智能体对话
- 通过复选框启用/禁用智能体功能
- 提供清晰的用户界面提示

### 2. 实时对话
- 基于用户输入的出生信息进行智能对话
- 支持文件上传和多媒体交互
- 完整的聊天界面体验

### 3. 智能分析
- 美观的聊天界面展示
- 支持多轮对话
- 响应式设计，适配不同屏幕尺寸

## 配置说明

### 环境变量配置

在项目根目录创建 `.env.local` 文件，添加以下配置：

```env
# 扣子智能体配置
VITE_COZE_BOT_ID=7547965462022193162
VITE_COZE_TOKEN=pat_zjpOuq7ytYhH8zTqkg7M3ygNpOLPvpGrg6MMZHXtg4ZHyb9CpCZwTg18CcVoIxMv
VITE_COZE_USER_ID=user_123
VITE_COZE_NICKNAME=用户
```

**重要：** 请手动创建 `.env.local` 文件并复制上述配置内容。

### 获取扣子配置信息

1. **Bot ID**: 在扣子平台创建智能体后获得
2. **Token**: 在扣子平台 API 设置中获取个人访问令牌
3. **User ID**: 可以是任意用户标识符
4. **Nickname**: 用户显示名称

## 技术实现

### 1. SDK 集成 (`index.html`)
- 通过 CDN 引入扣子 Web SDK
- 全局可用的 CozeWebSDK 对象

### 2. 类型定义 (`src/types/coze-sdk.d.ts`)
- 完整的 TypeScript 类型定义
- 支持智能体配置和客户端接口

### 3. 配置管理 (`src/lib/coze-config.ts`)
- 环境变量配置管理
- 配置验证和默认值处理

### 4. 聊天组件 (`src/components/CozeChatWidget.tsx`)
- 封装扣子 Web SDK 的 React 组件
- 支持自定义配置和事件处理
- 完整的错误处理和加载状态

### 5. 表单集成 (`src/components/BirthdayForm.tsx`)
- 集成智能体对话选项
- 处理对话流程
- 状态管理和错误处理

## 使用流程

1. 用户填写出生信息表单
2. 选择是否启用 AI 智能体对话
3. 点击"开启 AI 智能对话"按钮
4. 系统打开扣子聊天窗口
5. 用户可以与 AI 助手进行对话
6. 支持多轮对话和文件上传

## 错误处理

- 网络错误处理
- API 调用失败处理
- 用户友好的错误提示
- 重试机制

## 扩展功能

### 可扩展的功能点：
1. 支持图片上传分析（手相）
2. 多轮对话功能
3. 分析历史记录
4. 个性化推荐
5. 分享功能

## 注意事项

1. 确保扣子 API 配置正确
2. 注意 API 调用频率限制
3. 处理网络异常情况
4. 保护用户隐私信息

## 测试建议

1. 测试正常分析流程
2. 测试网络异常情况
3. 测试表单验证
4. 测试错误重试功能
5. 测试不同屏幕尺寸的响应式设计
