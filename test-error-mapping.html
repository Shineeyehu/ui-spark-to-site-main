<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>错误内容映射测试</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.6;
        }
        .test-case {
            border: 1px solid #ddd;
            margin: 20px 0;
            padding: 15px;
            border-radius: 5px;
        }
        .original {
            background-color: #f5f5f5;
            padding: 10px;
            margin: 10px 0;
            border-left: 4px solid #ff6b6b;
        }
        .mapped {
            background-color: #e8f5e8;
            padding: 10px;
            margin: 10px 0;
            border-left: 4px solid #4caf50;
        }
        .title {
            font-weight: bold;
            color: #333;
            margin-bottom: 10px;
        }
    </style>
</head>
<body>
    <h1>错误内容映射测试</h1>
    <p>测试手相识别失败时的错误信息映射功能</p>

    <div class="test-case">
        <div class="title">测试用例1：完整的手相错误信息</div>
        <div class="original">
            <strong>原始内容：</strong><br>
            您好，目前无法获取手相照片信息，可能是文件ID有误或系统暂时无法读取。为了更精准地完成"天地双盘+手相，参合互证"的深度分析，能否请您重新确认或提供有效的手相照片信息？
            重新提供一下手相照片的文件 ID。
            不考虑手相的话，能否对孩子进行命理分析？
            除了手相和天地双盘，还有哪些命理分析方法？
        </div>
        <div class="mapped">
            <strong>映射后内容：</strong><br>
            暂时无法获取手相信息，请您点击刷新后重试！
        </div>
    </div>

    <div class="test-case">
        <div class="title">测试用例2：手相特征描述错误</div>
        <div class="original">
            <strong>原始内容：</strong><br>
            您好，目前手相分析功能需要您提供手相的具体特征描述（如掌形、纹路特点等），而非文件ID。请您帮忙描述一下孩子手相的特征，比如掌形是方形、细长形还是其他形状？三大主纹（生命线、智慧线、感情线）是否清晰深刻？是否有特殊纹路或标记？这样我才能结合八字和紫微斗数为您进行全面的"天地双盘+手相"分析。
            请描述一下这个孩子的掌形和手指形状。
            这个孩子的手相上有哪些特殊的纹路或标记？
            他的智慧线和感情线有什么特点？
        </div>
        <div class="mapped">
            <strong>映射后内容：</strong><br>
            暂时无法获取手相信息，请您点击刷新后重试！
        </div>
    </div>

    <div class="test-case">
        <div class="title">测试用例3：部分手相错误信息</div>
        <div class="original">
            <strong>原始内容：</strong><br>
            无法获取手相照片信息，文件ID有误，系统暂时无法读取手相数据。
        </div>
        <div class="mapped">
            <strong>映射后内容：</strong><br>
            暂时无法获取手相信息，请您点击刷新后重试！
        </div>
    </div>

    <div class="test-case">
        <div class="title">测试用例4：正常内容（不应被映射）</div>
        <div class="original">
            <strong>原始内容：</strong><br>
            根据您提供的生辰八字，我为您进行详细的命理分析。孩子的八字为：乙巳 乙酉 辛巳 丁酉，日主辛金生于酉月，金气鼎盛...
        </div>
        <div class="mapped">
            <strong>映射后内容：</strong><br>
            根据您提供的生辰八字，我为您进行详细的命理分析。孩子的八字为：乙巳 乙酉 辛巳 丁酉，日主辛金生于酉月，金气鼎盛...
        </div>
    </div>

    <script>
        // 模拟错误映射函数
        function mapErrorContent(content) {
            if (!content || typeof content !== "string") {
                return content;
            }

            const errorMappings = [
                {
                    pattern: /您好，目前无法获取手相照片信息，可能是文件ID有误或系统暂时无法读取。为了更精准地完成"天地双盘\+手相，参合互证"的深度分析，能否请您重新确认或提供有效的手相照片信息？\s*重新提供一下手相照片的文件\s*ID。\s*不考虑手相的话，能否对孩子进行命理分析？\s*除了手相和天地双盘，还有哪些命理分析方法？/,
                    replacement: "暂时无法获取手相信息，请您点击刷新后重试！"
                },
                {
                    pattern: /您好，目前手相分析功能需要您提供手相的具体特征描述（如掌形、纹路特点等），而非文件ID。请您帮忙描述一下孩子手相的特征，比如掌形是方形、细长形还是其他形状？三大主纹（生命线、智慧线、感情线）是否清晰深刻？是否有特殊纹路或标记？这样我才能结合八字和紫微斗数为您进行全面的"天地双盘\+手相"分析。\s*请描述一下这个孩子的掌形和手指形状。\s*这个孩子的手相上有哪些特殊的纹路或标记？\s*他的智慧线和感情线有什么特点？/,
                    replacement: "暂时无法获取手相信息，请您点击刷新后重试！"
                },
                {
                    pattern: /无法获取手相照片信息|文件ID有误|系统暂时无法读取.*手相|手相分析功能需要您提供手相的具体特征描述/,
                    replacement: "暂时无法获取手相信息，请您点击刷新后重试！"
                }
            ];

            let mappedContent = content;
            
            for (const mapping of errorMappings) {
                if (mapping.pattern.test(mappedContent)) {
                    console.log('检测到手相错误信息，进行映射:', mapping.pattern);
                    mappedContent = mappedContent.replace(mapping.pattern, mapping.replacement);
                    break;
                }
            }

            return mappedContent;
        }

        // 测试函数
        function testErrorMapping() {
            const testCases = [
                {
                    name: "完整手相错误信息",
                    input: `您好，目前无法获取手相照片信息，可能是文件ID有误或系统暂时无法读取。为了更精准地完成"天地双盘+手相，参合互证"的深度分析，能否请您重新确认或提供有效的手相照片信息？
重新提供一下手相照片的文件 ID。
不考虑手相的话，能否对孩子进行命理分析？
除了手相和天地双盘，还有哪些命理分析方法？`,
                    expected: "暂时无法获取手相信息，请您点击刷新后重试！"
                },
                {
                    name: "手相特征描述错误",
                    input: `您好，目前手相分析功能需要您提供手相的具体特征描述（如掌形、纹路特点等），而非文件ID。请您帮忙描述一下孩子手相的特征，比如掌形是方形、细长形还是其他形状？三大主纹（生命线、智慧线、感情线）是否清晰深刻？是否有特殊纹路或标记？这样我才能结合八字和紫微斗数为您进行全面的"天地双盘+手相"分析。
请描述一下这个孩子的掌形和手指形状。
这个孩子的手相上有哪些特殊的纹路或标记？
他的智慧线和感情线有什么特点？`,
                    expected: "暂时无法获取手相信息，请您点击刷新后重试！"
                },
                {
                    name: "部分手相错误信息",
                    input: "无法获取手相照片信息，文件ID有误，系统暂时无法读取手相数据。",
                    expected: "暂时无法获取手相信息，请您点击刷新后重试！"
                },
                {
                    name: "正常内容",
                    input: "根据您提供的生辰八字，我为您进行详细的命理分析。孩子的八字为：乙巳 乙酉 辛巳 丁酉，日主辛金生于酉月，金气鼎盛...",
                    expected: "根据您提供的生辰八字，我为您进行详细的命理分析。孩子的八字为：乙巳 乙酉 辛巳 丁酉，日主辛金生于酉月，金气鼎盛..."
                }
            ];

            console.log("开始测试错误映射功能...");
            
            testCases.forEach((testCase, index) => {
                const result = mapErrorContent(testCase.input);
                const passed = result === testCase.expected;
                
                console.log(`测试用例 ${index + 1}: ${testCase.name}`);
                console.log(`输入: ${testCase.input.substring(0, 50)}...`);
                console.log(`期望: ${testCase.expected}`);
                console.log(`实际: ${result}`);
                console.log(`结果: ${passed ? '✅ 通过' : '❌ 失败'}`);
                console.log('---');
            });
        }

        // 页面加载完成后运行测试
        window.addEventListener('load', testErrorMapping);
    </script>
</body>
</html>
