<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ReportPage ç©ºç™½é¡µé¢ä¿®å¤æµ‹è¯•</title>
    <style>
        body {
            font-family: system-ui, -apple-system, sans-serif;
            margin: 0;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .status {
            padding: 10px;
            border-radius: 6px;
            margin: 10px 0;
        }
        .success { background: #d1fae5; color: #065f46; }
        .warning { background: #fef3c7; color: #92400e; }
        .error { background: #fee2e2; color: #991b1b; }
        .code {
            background: #f3f4f6;
            padding: 10px;
            border-radius: 4px;
            font-family: monospace;
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ”§ ReportPage ç©ºç™½é¡µé¢ä¿®å¤æµ‹è¯•</h1>
        
        <div class="status success">
            <strong>âœ… é—®é¢˜å·²è¯†åˆ«ï¼š</strong> ReportPage ä¾èµ– location.state ä¼ é€’æ•°æ®ï¼Œç›´æ¥è®¿é—® /report é¡µé¢æ—¶ location.state ä¸º undefined
        </div>

        <h2>ğŸ” é—®é¢˜åŸå› åˆ†æ</h2>
        <ul>
            <li><strong>æ•°æ®ä¾èµ–ï¼š</strong> ReportPage é€šè¿‡ location.state è·å– formDataã€analysisContent ç­‰æ•°æ®</li>
            <li><strong>æ¸²æŸ“æ¡ä»¶ï¼š</strong> æ‰€æœ‰å†…å®¹æ¸²æŸ“éƒ½ä¾èµ–è¿™äº›æ•°æ®çš„å­˜åœ¨</li>
            <li><strong>ç©ºçŠ¶æ€å¤„ç†ï¼š</strong> åŸæ¥çš„ç©ºçŠ¶æ€æ¡ä»¶è¿‡äºä¸¥æ ¼ï¼Œå¯¼è‡´ç©ºç™½é¡µé¢</li>
        </ul>

        <h2>ğŸ› ï¸ ä¿®å¤æ–¹æ¡ˆ</h2>
        <div class="code">
// 1. æ·»åŠ æ•°æ®æœ‰æ•ˆæ€§æ£€æŸ¥
const hasValidData = useMemo(() => {
  return !!(
    formData || 
    analysisContent || 
    moonshotResult || 
    externalInlineReportHtml ||
    streamState.messages.length > 0 ||
    aiAnalysisResult ||
    moonshotState.generatedHTML
  );
}, [formData, analysisContent, moonshotResult, externalInlineReportHtml, streamState.messages.length, aiAnalysisResult, moonshotState.generatedHTML]);

// 2. è‡ªåŠ¨é‡å®šå‘åˆ°ç”Ÿæ—¥é¡µé¢
useEffect(() => {
  if (!hasValidData && !fromBirthday && !fromDeepTalk) {
    console.log('ReportPage: æ²¡æœ‰æœ‰æ•ˆæ•°æ®ï¼Œ3ç§’åè‡ªåŠ¨è·³è½¬åˆ°ç”Ÿæ—¥é¡µé¢');
    const timer = setTimeout(() => {
      window.location.href = '/birthday';
    }, 3000);
    return () => clearTimeout(timer);
  }
}, [hasValidData, fromBirthday, fromDeepTalk]);

// 3. å‹å¥½çš„æ— æ•°æ®çŠ¶æ€æ˜¾ç¤º
{!hasValidData && !streamState.isStreaming && !streamState.error && (
  <div className="flex flex-col items-center justify-center py-12">
    <div className="text-center max-w-lg mx-auto">
      <h3>æ¬¢è¿æ¥åˆ°å‘½ç†åˆ†ææŠ¥å‘Š</h3>
      <p>è¯·å…ˆå¡«å†™å‡ºç”Ÿä¿¡æ¯ï¼Œç³»ç»Ÿå°†ä¸ºæ‚¨ç”Ÿæˆä¸ªæ€§åŒ–çš„å‘½ç†åˆ†ææŠ¥å‘Š</p>
      <Link to="/birthday">å¼€å§‹åˆ†æ</Link>
      <div>3ç§’åè‡ªåŠ¨è·³è½¬åˆ°åˆ†æé¡µé¢...</div>
    </div>
  </div>
)}
        </div>

        <h2>âœ… ä¿®å¤æ•ˆæœ</h2>
        <div class="status success">
            <strong>1. æ•°æ®éªŒè¯ï¼š</strong> æ·»åŠ äº† hasValidData æ£€æŸ¥ï¼Œå‡†ç¡®åˆ¤æ–­æ˜¯å¦æœ‰æœ‰æ•ˆæ•°æ®
        </div>
        <div class="status success">
            <strong>2. è‡ªåŠ¨é‡å®šå‘ï¼š</strong> æ— æ•°æ®æ—¶è‡ªåŠ¨è·³è½¬åˆ°ç”Ÿæ—¥é¡µé¢ï¼Œé¿å…ç©ºç™½é¡µé¢
        </div>
        <div class="status success">
            <strong>3. å‹å¥½æç¤ºï¼š</strong> æ˜¾ç¤ºå¼•å¯¼ä¿¡æ¯å’Œå€’è®¡æ—¶ï¼Œæå‡ç”¨æˆ·ä½“éªŒ
        </div>
        <div class="status success">
            <strong>4. ä¿æŒå…¼å®¹ï¼š</strong> ä¸å½±å“æ­£å¸¸çš„æ•°æ®ä¼ é€’å’Œæ˜¾ç¤ºæµç¨‹
        </div>

        <h2>ğŸ§ª æµ‹è¯•åœºæ™¯</h2>
        <ol>
            <li><strong>ç›´æ¥è®¿é—® /reportï¼š</strong> åº”æ˜¾ç¤ºå¼•å¯¼ä¿¡æ¯å¹¶è‡ªåŠ¨è·³è½¬</li>
            <li><strong>ä» /birthday è·³è½¬ï¼š</strong> æ­£å¸¸æ˜¾ç¤ºåˆ†æç»“æœ</li>
            <li><strong>ä» /deeptalk è·³è½¬ï¼š</strong> æ­£å¸¸æ˜¾ç¤ºæ·±åº¦å’¨è¯¢ç»“æœ</li>
            <li><strong>æœ‰æ•°æ®ä½†æ— å†…å®¹ï¼š</strong> æ˜¾ç¤ºé»˜è®¤å›¾ç‰‡</li>
        </ol>

        <div class="status warning">
            <strong>âš ï¸ æ³¨æ„äº‹é¡¹ï¼š</strong> ä¿®å¤åéœ€è¦é‡æ–°éƒ¨ç½²åˆ° Vercel æ‰èƒ½ç”Ÿæ•ˆ
        </div>
    </div>
</body>
</html>
